<header class="site-header">
  <div class="container header-inner">
    <!-- Brand -->
    <a
      class="brand"
      [routerLink]="isAdmin ? '/admin-dashboard' : '/'"
      aria-label="ReserveOne home"
      (click)="closeNav.emit()"
      [class.disabled]="isAdmin"
      [attr.tabindex]="isAdmin ? -1 : 0"
      [attr.aria-disabled]="isAdmin ? 'true' : null"
      (click)="isAdmin ? $event.preventDefault() : null"
    >
      <span class="brand-mark" aria-hidden="true"></span>
      <span class="brand-text">
        <span class="brand-name">ReserveOne</span>
        <span class="brand-tag">Smarter stays â€¢ Better booking</span>
      </span>
    </a>

    <!-- Navigation (now a component) -->
    <app-nav [isOpen]="isNavOpen" (toggle)="toggleNav.emit()" (close)="closeNav.emit()"></app-nav>

    <!-- Actions -->
    <div class="header-actions">
      <button class="btn btn-ghost" type="button" (click)="openBooking.emit()">Search</button>

      @if (!isAuthenticated) {
      <button class="btn btn-primary" type="button" (click)="openSignIn.emit(); closeNav.emit()">
        Sign in
      </button>
      } @else {
      <div class="user-menu">
        <button
          class="avatar-btn"
          type="button"
          aria-label="Open user menu"
          (click)="toggleUserMenu()"
        >
          <span class="avatar">{{ avatarText }}</span>
        </button>

        @if (userMenuOpen) {
        <div class="menu-backdrop" (click)="closeUserMenu()"></div>
        <div
          class="menu-panel"
          role="menu"
          aria-label="User menu"
          (click)="$event.stopPropagation()"
        >
          @if (roleLabel) {
          <div class="menu-role" aria-label="Current role">{{ roleLabel }}</div>
          } @if (isAdmin) {
          <button class="menu-item" type="button" role="menuitem" (click)="onOpenAdminDashboard()">
            Admin Dashboard
          </button>
          @if (showSystemSettings) {
          <button class="menu-item" type="button" role="menuitem" (click)="onOpenSystemSettings()">
            System settings
          </button>
          }
          <button
            class="menu-item"
            type="button"
            role="menuitem"
            (click)="onOpenPaymentTransactions()"
          >
            Payment Transactions
          </button>
          } @else {
          <button class="menu-item" type="button" role="menuitem" (click)="onOpenMyBookings()">
            My Bookings
          </button>
          }
          <button class="menu-item" type="button" role="menuitem" (click)="onOpenProfile()">
            Profile settings
          </button>
          <button class="menu-item danger" type="button" role="menuitem" (click)="onLogout()">
            Log out
          </button>
        </div>
        }
      </div>
      }
    </div>
  </div>
</header>
